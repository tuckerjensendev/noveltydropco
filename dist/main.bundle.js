(()=>{var e,t,n=!1,o=!1;function i(){var e=document.getElementById("loadingSpinner");e&&(e.style.display="flex")}function r(){var e=document.getElementById("loadingSpinner");e&&(e.style.display="none")}function s(){var e=document.getElementById("register_password"),t=document.getElementById("confirm_password");if(e&&t){var n=e.value,o=t.value,i=document.querySelector('[data-requirement="length"]'),r=document.querySelector('[data-requirement="uppercase"]'),s=document.querySelector('[data-requirement="number"]'),d=document.querySelector('[data-requirement="match"]'),a=n.length>=8,l=/[A-Z]/.test(n),u=/\d/.test(n),m=n===o&&""!==n;c(i,a),c(r,l),c(s,u),c(d,m)}}function c(e,t){e&&(t?e.classList.add("met"):e.classList.remove("met"))}function d(){var e=document.getElementById("dropdown"),t=document.getElementById("login-form"),i=document.getElementById("register-form"),r=document.querySelector(".sign-in-button");e&&t&&i?(n=!0,o=!0,e.classList.add("show","register-mode"),t.classList.add("hidden"),i.classList.remove("hidden"),null==r||r.classList.add("active-border"),sessionStorage.setItem("showRegisterForm","true"),sessionStorage.removeItem("showLoginForm")):console.error("One or more elements missing for showRegisterForm.")}function a(){var e=document.getElementById("dropdown"),t=document.getElementById("login-form"),i=document.getElementById("register-form"),r=document.querySelector(".sign-in-button");e&&t&&i?(n=!0,o=!1,e.classList.add("show"),e.classList.remove("register-mode"),i.classList.add("hidden"),t.classList.remove("hidden"),null==r||r.classList.add("active-border"),sessionStorage.setItem("showLoginForm","true"),sessionStorage.removeItem("showRegisterForm")):console.error("One or more elements missing for showLoginForm.")}function l(e){e.stopPropagation();var t=document.getElementById("dropdown");n?u():(t&&t.classList.add("show"),n=!0)}function u(){var o=document.getElementById("dropdown"),i=document.querySelector(".sign-in-button");o?(n=!1,o.classList.remove("show","register-mode"),null==i||i.classList.remove("active-border"),sessionStorage.removeItem("showLoginForm"),sessionStorage.removeItem("showRegisterForm"),sessionStorage.removeItem("loginEmail"),sessionStorage.removeItem("registerFirstName"),sessionStorage.removeItem("registerLastName"),sessionStorage.removeItem("registerEmail"),["click","keypress","scroll","touchstart"].forEach((function(e){window.removeEventListener(e,resetInactivityTimer)})),clearTimeout(e),clearTimeout(t),clearInterval(m),hideWarningPopup()):console.error("Dropdown element is missing.")}var m,g=!1;document.addEventListener("DOMContentLoaded",(function(){if(sessionStorage.getItem("sessionTimeoutLogged")){var e=document.createElement("div");e.id="logoutPopup",e.classList.add("timeoutpopup"),e.innerHTML='\n      <p id="timed-out-logout"><strong>You have been logged out due to inactivity.</strong></p>\n      <p>Please log back in to continue.</p>\n    ',document.body.appendChild(e),sessionStorage.removeItem("sessionTimeoutLogged"),document.addEventListener("click",(function t(n){e.contains(n.target)||(document.body.removeChild(e),document.removeEventListener("click",t))}))}})),document.addEventListener("DOMContentLoaded",(function(){var c,v,f,p,E,h,y,L,I,w,b,k,B,S;i(),window.addEventListener("load",r),c=document.getElementById("show-register"),v=document.getElementById("show-login"),f=document.querySelector(".sign-in-button"),p=document.getElementById("profile-picture"),E=document.getElementById("dropdown"),null==c||c.addEventListener("click",(function(e){e.preventDefault(),d()})),null==v||v.addEventListener("click",(function(e){e.preventDefault(),a()})),null==f||f.addEventListener("click",(function(e){e.preventDefault(),n?u():a()})),null==p||p.addEventListener("click",l),document.addEventListener("click",(function(e){!E||E.contains(e.target)||null!=f&&f.contains(e.target)||o||u()})),function(){var e="true"===sessionStorage.getItem("showLoginForm"),t="true"===sessionStorage.getItem("showRegisterForm");e?a():t?d():u();var n=document.getElementById("email"),o=document.getElementById("first_name"),i=document.getElementById("last_name"),r=document.getElementById("register_email");n&&(n.value=sessionStorage.getItem("loginEmail")||""),o&&(o.value=sessionStorage.getItem("registerFirstName")||""),i&&(i.value=sessionStorage.getItem("registerLastName")||""),r&&(r.value=sessionStorage.getItem("registerEmail")||"")}(),null===(h=document.getElementById("email"))||void 0===h||h.addEventListener("input",(function(e){sessionStorage.setItem("loginEmail",e.target.value)})),null===(y=document.getElementById("first_name"))||void 0===y||y.addEventListener("input",(function(e){sessionStorage.setItem("registerFirstName",e.target.value)})),null===(L=document.getElementById("last_name"))||void 0===L||L.addEventListener("input",(function(e){sessionStorage.setItem("registerLastName",e.target.value)})),null===(I=document.getElementById("register_email"))||void 0===I||I.addEventListener("input",(function(e){sessionStorage.setItem("registerEmail",e.target.value)})),document.querySelectorAll("form").forEach((function(e){e.addEventListener("submit",i)})),function(){var e=document.getElementById("flashMessage");if(e){var t=setTimeout((function(){e.style.display="none"}),2e4);e.addEventListener("click",(function(n){n.stopPropagation(),e.style.display="none",clearTimeout(t)}))}}(),function(){var e=document.querySelectorAll('input[type="checkbox"]'),t=document.getElementById("saveChangesButton");function n(){if(t){var n=Array.from(e).some((function(e){return e.checked.toString()!==e.getAttribute("data-original")}));t.disabled=!n}}e.forEach((function(e){e.addEventListener("change",n)}));var o=new MutationObserver((function(e){e.forEach((function(e){"attributes"===e.type&&"checked"===e.attributeName&&n()}))}));e.forEach((function(e){return o.observe(e,{attributes:!0})})),n()}(),(k=(b={"/admin/superadmin-dashboard":"superAdminDashboardLink","/admin/staff-dashboard":"dashboardLink","/admin/create-staff":"createStaffLink","/admin/manage-access":"manageAccessLink","/admin/content-workshop":"contentWorkshopLink"})[window.location.pathname])&&(null===(w=document.getElementById(k))||void 0===w||w.classList.add("active-border")),Object.values(b).forEach((function(e){var t=document.getElementById(e);t&&t.addEventListener("click",(function(e){document.querySelectorAll(".staff-header-content a").forEach((function(e){e.classList.remove("active")})),e.currentTarget.classList.add("active")}))})),B=document.getElementById("logoutForm"),S=document.getElementById("logoutButton"),B&&S&&B.addEventListener("submit",(function(e){S.disabled=!0})),document.body.getAttribute("data-user-id")&&function(){var n=document.createElement("div");function o(){g||(clearTimeout(e),clearTimeout(t),s(),t=setTimeout((function(){!function(e){g=!0,n.style.display="flex",n.innerHTML='\n      <p id="main-timeout-warning-line"><strong>You have been inactive for 14 minutes.</strong></p>\n      <p>You will be logged out in <strong><span id="countdown">'.concat(e,'</span></strong> seconds.</p>\n      <p id="click-anywhere-warning">Click anywhere to dismiss</p>\n    ');var t=document.getElementById("countdown");m=setInterval((function(){e--,t.textContent=e,e<=0&&(clearInterval(m),s())}),1e3),document.addEventListener("click",r)}(60)}),84e4),e=setTimeout((function(){!function(){if(!sessionStorage.getItem("sessionTimeoutLogged")){sessionStorage.setItem("sessionTimeoutLogged","true");var e={userId:document.body.getAttribute("data-user-id"),role:document.body.getAttribute("data-role"),ip:document.body.getAttribute("data-ip")};console.log("Logging session timeout with data:",e),fetch("/admin/log-session-timeout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw new Error("Network response was not ok");console.log("Session timeout logged successfully.")})).catch((function(e){return console.error("Error logging session timeout:",e)}))}}();var e=document.getElementById("logoutForm");e?(i(),e.submit()):console.error("Logout form not found.")}),9e5))}function r(e){g&&("warningPopup"!==e.target.id&&n.contains(e.target)||(g=!1,s(),clearInterval(m),document.removeEventListener("click",r)))}function s(){n.style.display="none"}n.id="warningPopup",n.classList.add("timeoutpopup"),document.body.appendChild(n),["click","keypress","scroll","touchstart"].forEach((function(e){window.addEventListener(e,o)})),o()}();var T=document.getElementById("register_password"),D=document.getElementById("confirm_password"),F=document.getElementById("password-requirements-container"),q=document.getElementById("password-requirements");function C(){F&&F.classList.add("show"),q&&q.classList.remove("hidden")}null==T||T.addEventListener("focus",C),null==D||D.addEventListener("focus",C),null==T||T.addEventListener("input",s),null==D||D.addEventListener("input",s),document.addEventListener("click",(function(e){T&&T.value||D&&D.value||!F||F.contains(e.target)||e.target===T||e.target===D||(F&&F.classList.remove("show"),q&&q.classList.add("hidden"))}))}))})(),document.addEventListener("DOMContentLoaded",(function(){console.log("[DEBUG] homeContent.js loaded and DOMContentLoaded triggered.");var e,t=document.getElementById("contentDisplay");t?(console.log("[DEBUG] Grid container found."),e="home",console.log("[DEBUG] Fetching layout for page ID: ".concat(e)),fetch("/api/content/".concat(e)).then((function(e){return console.log("[DEBUG] Fetch response status: ".concat(e.status)),e.json()})).then((function(e){console.log("[DEBUG] Fetched blocks:",JSON.stringify(e,null,2));var n=function(e){for(var t=[],n=0;n<e.length;){var o=e[n],i=e[n+1];"block-grid-small"===o.type&&"block-grid-medium"===(null==i?void 0:i.type)||"block-grid-medium"===o.type&&"block-grid-small"===(null==i?void 0:i.type)?(t.push({type:"group-wrapper",blocks:[o,i]}),console.log("[DEBUG] Grouped blocks ".concat(o.block_id," and ").concat(i.block_id," into a group.")),n+=2):(t.push(o),n+=1)}return t}(e);!function(e){t.innerHTML="",e.forEach((function(e){if("group-wrapper"===e.type){var n=document.createElement("div");n.className="group-wrapper",e.blocks.forEach((function(e){var t=document.createElement("div");t.className="grid-item ".concat(e.type),t.dataset.blockId=e.block_id,t.innerHTML='<div class="block-content">'.concat(e.content||"","</div>"),n.appendChild(t)})),t.appendChild(n),console.log("[DEBUG] Appended a grouped block to the grid.")}else{var o=document.createElement("div");o.className="grid-item ".concat(e.type),o.dataset.blockId=e.block_id,"block-banner"!==e.type&&"block-spacer-banner"!==e.type||o.classList.add("full-width-block"),o.innerHTML='<div class="block-content">'.concat(e.content||"","</div>"),t.appendChild(o),console.log("[DEBUG] Appended an individual block to the grid.")}})),console.log("[DEBUG] Finished rendering blocks. Grid container state:",t.innerHTML)}(n)})).catch((function(e){return console.error("[ERROR] Failed to fetch layout:",e)}))):console.error("[DEBUG] Grid container not found. Exiting.")})),document.addEventListener("DOMContentLoaded",(function(){var e=io();e.on("connect",(function(){console.log("Connected to server via Socket.IO")})),e.on("serverShutdown",(function(e){alert(e.message),fetch("/logout",{method:"POST"}).then((function(){window.location.href="/login"})).catch((function(e){console.error("Error during logout:",e),window.location.href="/login"}))})),e.on("disconnect",(function(t){console.warn("Disconnected from server: ".concat(t)),"io server disconnect"===t&&e.connect()})),e.on("reconnect_attempt",(function(){console.log("Attempting to reconnect to the server...")})),e.on("reconnect_failed",(function(){console.error("Reconnection failed. Redirecting to login."),fetch("/logout",{method:"POST"}).then((function(){window.location.href="/login"})).catch((function(){window.location.href="/login"}))}))}));